# 外部設計書

## 改訂履歴

| バージョン | 改訂日     | 担当者 | 概要                   |
| :--- | :--- | :--- | :--- |
| 1.0.0    | 2025-07-01 | Gemini | 初版作成               |
| 1.0.1    | 2025-07-09 | Gemini | 修正なし（影響範囲外） |
| 1.0.2    | 2025-07-10 | Gemini | Issue#4に伴う更新 |
| 1.0.3    | 2025-07-11 | Gemini | Issue#6に伴う作成日機能の追加 |

## 1. 画面レイアウト

### 1.1. 全体構成

アプリケーションは単一の画面で構成される。画面は以下の要素から成る。

- **ヘッダー:**
    - アプリケーションのタイトル（「TODOリスト」）
    - テーマ切り替えスイッチ（太陽と月のアイコン付き）
- **タスク入力エリア:**
    - タスク名を入力するテキストボックス
    - タスクを追加する「追加」ボタン
- **タスク検索エリア:**
    - タスクを検索するためのテキストボックス
- **コントロールエリア:**
    - タスクをフィルタリングするボタン（「すべて」「未完了」「完了済み」「繰り返し」）
    - 未完了のタスク数を表示するカウンター
- **タスクリストエリア:**
    - 追加されたタスクが一覧で表示される
- **完了タスク一括削除エリア:**
    - 完了済みタスクをまとめて削除するボタン
- **エクスポートエリア:**
    - エクスポート対象を選択するドロップダウンリスト
    - CSVファイルを出力する「CSV出力」ボタン

### 1.2. タスク要素

リスト内の各タスクは以下の要素を持つ。

- **タスク名:** タスクの内容を表示するテキスト。クリックすることで完了/未完了を切り替える。
- **期日:** 設定されている場合、期日を表示する。期限が過ぎている場合は赤色で強調表示される。
- **繰り返しステータス:** 繰り返しが設定されている場合、そのルール（「毎日」「毎週」など）を表示する。
- **繰り返し設定ボタン:** 繰り返しアイコンのボタン。クリックすると繰り返し設定用のポップアップ（モーダル）が表示される。
- **期日設定ボタン:** カレンダーアイコンのボタン。クリックすると日付入力欄が表示され、期日を設定・変更できる。
- **編集ボタン:** 鉛筆アイコンのボタン。クリックするとタスク名を直接編集できる状態になる。
- **削除ボタン:** ゴミ箱アイコンのボタン。クリックするとそのタスクを削除する。

繰り返しが設定されたタスク（テンプレートタスク）は、特別なアイコン（クローンアイコン）がタスク名の前に表示され、完了操作が無効になる。

- **タグ表示:** 設定されたタグがタスク名の下に表示される。
- **優先度表示:** 優先度がアイコンや色で視覚的に表示される。
- **作成日:** タスクが作成された日時を表示する。

## 2. 画面遷移

本アプリケーションは単一ページアプリケーション（SPA）であり、画面遷移は発生しない。すべての操作は同一画面内で完結する。

## 3. インタラクション

### 3.1. タスクの追加

1.  ユーザーがタスク入力エリアにテキストを入力する。
2.  「追加」ボタンをクリックするか、Enterキーを押す。
3.  入力されたテキストが新しいタスクとしてタスクリストの末尾に追加される。
4.  入力エリアのテキストはクリアされる。

### 3.2. タスクの完了/未完了

1.  ユーザーがタスク名をクリックする。
2.  タスクの表示スタイルが変更される（完了時は打ち消し線が引かれる）。
3.  未完了タスク数が更新される。

### 3.3. タスクの編集

1.  ユーザーが編集ボタンをクリックする。
2.  タスク名、タグ、優先度の入力フィールドが表示され、編集可能な状態になる。
3.  ユーザーが新しいテキスト、タグ、優先度を入力し、フォーカスを外すかEnterキーを押す、または「完了」ボタンをクリックする。
4.  タスク名、タグ、優先度が更新される。

### 3.4. タスクの削除

1.  ユーザーが削除ボタンをクリックする。
2.  該当のタスクがリストから削除される。

### 3.5. タスクのフィルタリング

1.  アプリケーション起動時、デフォルトでは「未完了」フィルタが適用された状態でタスクが表示される。
2.  ユーザーがコントロールエリアのフィルタボタン（「すべて」「未完了」「完了済み」「繰り返し」）をクリックする。
3.  タスクリストが選択された状態に応じて再描画される。
4.  アクティブなフィルタボタンのスタイルが変更される。

### 3.6. タスクの検索

1.  ユーザーが検索エリアにキーワードを入力する。
2.  入力中にリアルタイムで、現在のフィルタ条件に合致し、かつキーワードを含むタスクのみが表示される。

### 3.7. ドラッグ＆ドロップによる並べ替え

1.  ユーザーがタスクをドラッグする。
2.  ドラッグ中のタスクは半透明で表示される。
3.  ユーザーがタスクをドロップすると、その位置にタスクが移動し、順序が変更される。

### 3.8. テーマの切り替え

1.  ユーザーがヘッダーのテーマ切り替えスイッチをクリックする。
2.  アプリケーション全体の配色がライトモード/ダークモードに即座に切り替わる。

### 3.9. CSVエクスポート

1.  ユーザーがエクスポート対象（「すべて」「未完了」「完了済み」）を選択する。
2.  「CSV出力」ボタンをクリックする。
3.  選択されたタスクが`tasks.csv`というファイル名でダウンロードされる。CSVファイルには、タスク名、状態、期日に加え、タグと優先度の情報も含まれる。

### 3.10. 繰り返しタスクの設定

1.  ユーザーが繰り返し設定ボタンをクリックする。
2.  繰り返し設定用のポップアップが表示される。
3.  ユーザーが繰り返しの種類（「毎日」「毎週」「毎月」など）と詳細（曜日や日付）を選択する。
4.  「保存」ボタンをクリックすると、設定がタスクに保存され、ポップアップが閉じる。
5.  タスクの見た目が即座に更新され、繰り返しステータスとテンプレートアイコンが表示される。
6.  アプリケーションの次回読み込み時、設定に基づいて新しいタスクが自動で生成される。

### 3.11. タグ・優先度設定

1.  ユーザーがタスクの編集画面または新規作成画面で、タグ入力欄にタグを入力する（複数可）。
2.  優先度選択ドロップダウンから優先度（高・中・低）を選択する。
3.  保存ボタンをクリックすると、タグと優先度がタスクに反映される。
4.  タスク一覧画面で、タグによるフィルタリングや優先度による並べ替えが可能になる。